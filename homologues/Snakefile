GENOMES = ["c_briggsae.PRJNA10731.WS284", "c_japonica.PRJNA12591.WS284"]
EXTS = [".ndb", ".nhr", ".nin", ".njs", ".not", ".nsq", ".ntf", ".nto"]

rule all:
	input:
		#expand("blastdbs/{genome}.blastdb.dummy", genome=GENOMES)
		expand("output/{genome}.blastout.tsv", genome=GENOMES)
		
rule makeblastdb:
	input:
		"input/ref/{genome}.genomic.fa"
	output:
		touch("blastdbs/{genome}.blastdb.dummy")
	shell:
		"makeblastdb -in {input} -dbtype nucl -out blastdbs/{wildcards.genome}.blastdb"

rule run_blastn:
	input:
		expand("blastdbs/{genome}.blastdb{ext}", genome=GENOMES, ext=EXTS)
	output:
		"output/{genome}.blastout.tsv"		
	shell:
		"blastn -db blastdbs/{wildcards.genome}.blastdb -query input/apc_test/ch.10010.fa "
		"-evalue 1e-3 -outfmt '7 std stitle' > {output}"
